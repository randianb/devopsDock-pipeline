# pgAdmin 4 configuration for external PostgreSQL
CONFIG_DATABASE_URI = "postgresql://{{ pgadmin_db_user }}:{{ pgadmin_db_password }}@{{ pgadmin_db_host }}:{{ pgadmin_db_port }}/{{ pgadmin_db_name }}"

DATA_DIR = '/pgadmin/data'
LOG_FILE = '/var/log/pgadmin4/pgadmin4.log'



####ansible tasks:

- name: Configure pgAdmin to use external PostgreSQL
  template:
    src: config_local.py.j2
    dest: /etc/pgadmin4/config_local.py
    owner: root
    group: root
    mode: '0644'
  notify: Restart Apache HTTPD

###handelers
- name: Restart Apache HTTPD
  systemd:
    name: httpd
    state: restarted

###error
TASK [pgadmin4 : Execute setup-web script] *************************************
fatal: []: FAILED! => {"msg": "An unhandled exception occurred while running the lookup plugin 'hashi_vault'. Error was a <class 'hvac.exceptions.Forbidden'>, original message: permission denied, on post ****/v1/auth/approle/login"}
here's my tasks: 
- name: Execute setup-web script
  become: true
  shell: |
    /usr/pgadmin4/bin/setup-web.sh
  args: 
     creates: /var/lib/pgadmin/pgadmin4.db
  environment:
    PGADMIN_SETUP_EMAIL: "{{ pgadmin_setup_email }}"
    PGADMIN_SETUP_PASSWORD: "{{ pgadmin_setup_password }}"
pgadmin_setup_email: "{{ lookup('hashi_vault', 'secret=kv/data/xsf/pgadmin4:pgadmin_setup_email auth_method=approle role_id={{ VAULT_ROLE }} secret_id={{ VAULT_SECRET }} url={{ VAULT_URL }} namespace={{ VAULT_NAMESPACE }} validate_certs=false')}}"
pgadmin_setup_password: "{{ lookup('hashi_vault', 'secret=kv/data/xsf/pgadmin4:pgadmin_setup_password auth_method=approle role_id={{ VAULT_ROLE }} secret_id={{ VAULT_SECRET }} url={{ VAULT_URL }} namespace={{ VAULT_NAMESPACE }} validate_certs=false')}}"

knowing that vault role id and secret id are set correctly 
