# pgAdmin 4 configuration for external PostgreSQL
CONFIG_DATABASE_URI = "postgresql://{{ pgadmin_db_user }}:{{ pgadmin_db_password }}@{{ pgadmin_db_host }}:{{ pgadmin_db_port }}/{{ pgadmin_db_name }}"

DATA_DIR = '/pgadmin/data'
LOG_FILE = '/var/log/pgadmin4/pgadmin4.log'



####ansible tasks:

- name: Configure pgAdmin to use external PostgreSQL
  template:
    src: config_local.py.j2
    dest: /etc/pgadmin4/config_local.py
    owner: root
    group: root
    mode: '0644'
  notify: Restart Apache HTTPD

###handelers
- name: Restart Apache HTTPD
  systemd:
    name: httpd
    state: restarted

###error
create ansible task that will used vault role id and secret id stored on this task " name: Write Vault Role ID to file
  become: true
  copy:
    content: "VAULT_ROLE: {{ VAULT_ROLE }}\nVAULT_SECRET: {{ VAULT_SECRET }}"
    dest: /tmp/vault_info.txt
    mode: '0644'
" and do a curl that look like this to get the content of the following varible stored on the vault "pgadmin_setup_email" and "pgadmin_setup_password", the curl look like this "curl --request POST --data '{"role_id": "", "secret_id": ""}' https://vault.com/v1/myVault/XSF_AF567_DEV_master/auth/approle/login
curl --header "X-Vault-Token: hvs.CAESIEOHhnSl8z0FPSQI2U5tkS_1fibFyeNKUNVFaJEZzuGvGisKImh2cy5GQWVwOXpTM0pDTm5CRkFXVWZMdkI5SDMuU01VVVgQw9ybDhgD" https://vault.com/v1/myVault/XSF_AF567_DEV_master/kv/data/xsf/pgadmin4"
