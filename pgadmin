#!/bin/bash

# Set SMTP details
SMTP_HOST="your.smtp.server"
SMTP_PORT=25
MAIL_FROM="devops.monitoring@domain.com"
MAIL_TO="example@domain.com"

# Read server name from the first argument
SERVER_NAME=$1

# Function to send an email
send_email() {
    local subject=$1
    local message=$2
    local temp_file=$(mktemp)

    echo -e "Subject: $subject\nContent-Type: text/html; charset=UTF-8\n\n<html><body><h3 style='color:red;'>$subject</h3><p>$message</p></body></html>" > "$temp_file"

    curl -s --url "smtp://$SMTP_HOST:$SMTP_PORT" --mail-from "$MAIL_FROM" --mail-rcpt "$MAIL_TO" --upload-file "$temp_file"

    rm -f "$temp_file"
}

# Send notification email
send_email "⚠️ Image Mismatch Alert for $SERVER_NAME" "The server <strong>$SERVER_NAME</strong> has different images across instances. Please investigate."

exit 0